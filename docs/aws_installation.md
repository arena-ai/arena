---
title: Install Arena on AWS
---

# Deploying [Arena](https://github.com/arena-ai/arena) on AWS EKS

To provision an [EKS cluster on AWS](https://docs.aws.amazon.com/eks/latest/userguide/create-cluster.html), you'll need an AWS account.

You'll also need [EKS command line interface](https://eksctl.io/) (`eksctl`) and [Kubernetes command line tool](https://kubernetes.io/docs/reference/kubectl/) (`kubectl`).
Make sure you have them installed.

## Create a few environment variables

You can parametrize the deployment of [Arena](https://github.com/arena-ai/arena) using environment variables:
```sh
export CLUSTER_NAME="arena-dev"
export REGION="eu-north-1"
export NODE_GROUP_NAME="arena-nodes"
export RELEASE_NAME="sarus"
# export PUBLIC_IP="104.46.33.202"
export CLUSTER_HOST="arena-staging.sarus.app"
export POSTGRES_USER="postgres"
export POSTGRES_PASSWORD="$(openssl rand -base64 12)"
export REDIS_PASSWORD="$(openssl rand -base64 12)"
export FIRST_SUPERUSER="admin@sarus.tech"
export FIRST_SUPERUSER_PASSWORD="$(openssl rand -base64 12)"
export SMTP_HOST="<your_smtp_server>"
export SMTP_USER="<your_smtp_user>"
export SMTP_USER="<your_smtp_password>"
export USERS_OPEN_REGISTRATION=False
```

Set them to fit your needs. Make sure the region you choose enables the provisioning of GPUs if you plan to use AI model fine-tuning features.

Note down the `FIRST_SUPERUSER_PASSWORD` you just generated by printing it:
```sh
echo $FIRST_SUPERUSER_PASSWORD
```

You will need it to log into the app as `admin@sarus.tech` (`FIRST_SUPERUSER`).

## Create the cluster

The cluster itself can be created with the command below:

```sh
eksctl create cluster --name $CLUSTER_NAME --region $REGION --version 1.30 --without-nodegroup
```

We then add nodes to our cluster by creating nodegroups

```sh
eksctl create nodegroup \
  --cluster $CLUSTER_NAME \
  --region $REGION \
  --name $NODE_GROUP_NAME \
  --node-ami-family Ubuntu2204 \
  --node-type m5.xlarge \
  --nodes 2 \
  --nodes-min 2 \
  --nodes-max 5
```

## Check you can access the cluster

```sh
# E.g.
kubectl get nodes
```

## Create an IAM OIDC provider

See [documentation](https://docs.aws.amazon.com/eks/latest/userguide/enable-iam-roles-for-service-accounts.html)

```sh
OIDC_ID=$(aws eks describe-cluster --name $CLUSTER_NAME  --region $REGION --query "cluster.identity.oidc.issuer" --output text | cut -d '/' -f 5)
eksctl utils associate-iam-oidc-provider --cluster $CLUSTER_NAME --approve --region $REGION
aws iam list-open-id-connect-providers | grep $OIDC_ID | cut -d "/" -f4
```

## Install EBS CSI driver

See [documentation](https://docs.aws.amazon.com/eks/latest/userguide/ebs-csi.html)

To provision storage, Kubernetes uses [CSI](https://kubernetes.io/docs/concepts/storage/volumes/#csi)

Create Amazon EBS CSI driver IAM role:
```sh
eksctl create iamserviceaccount \
  --region $REGION \
  --name "${CLUSTER_NAME}-ebs-csi-controller-sa" \
  --namespace kube-system \
  --cluster $CLUSTER_NAME \
  --attach-policy-arn arn:aws:iam::aws:policy/service-role/AmazonEBSCSIDriverPolicy \
  --approve \
  --role-only \
  --role-name "${CLUSTER_NAME}-AmazonEKS_EBS_CSI_DriverRole"
```

## Check the cluster configuration

You have now a working cluster ready to run the [Arena](https://github.com/arena-ai/arena) app